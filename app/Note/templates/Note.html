<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <meta name="description" content="">
        <meta name="author" content="">

        <title>SnapNotes</title>

        <!-- CSS FILES -->     
        <link rel="icon" type="image/x-icon" href="{{ url_for('Home.static', filename='images/Icons/remarques.png')}}">   
        <link rel="preconnect" href="https://fonts.googleapis.com">
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">

        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700&family=Open+Sans&display=swap" rel="stylesheet">
                        
    <link rel="stylesheet" href="{{ url_for('Note.static', filename='css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('Note.static', filename='css/bootstrap-icons.css') }}">
    <link rel="stylesheet" href="{{ url_for('Note.static', filename='css/templatemo-topic-listing.css') }}">
<!--

TemplateMo 590 topic listing

https://templatemo.com/tm-590-topic-listing

-->
    </head>
    
    <body id="top">
        <main>

            <nav class="navbar navbar-expand-lg">
                <div class="container">
                    <a class="navbar-brand" href="/">
                        <i class="bi-back"></i>
                        <span>SnapNotes</span>
                    </a>

                    <div class="d-lg-none ms-auto me-4">
                        <a href="#top" class="navbar-icon bi-person smoothscroll"></a>
                    </div>
    
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
    
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav ms-lg-5 me-lg-auto">
                            <li class="nav-item">
                                <a class="nav-link click-scroll" href="#section_1">Add Note</a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-link click-scroll" href="/Notes">My notes</a>
                            </li>
                            <!--
                            <li class="nav-item">
                                <a class="nav-link click-scroll" href="#section_3">How it works</a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-link click-scroll" href="#section_4">FAQs</a>
                            </li>
                            -->
                            <li class="nav-item">
                                <a class="nav-link click-scroll" href="#section_5">Contact</a>
                            </li>
                        </ul>

                        <ul class="navbar-nav ">
                            <li class="nav-item">
                                <a class="" href="/Login">
                                    Logout&nbsp;
                                    <i class="fas fa-sign-out-alt"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
            <br><br>
            <section class="explore-section section-padding" id="section_1">
                <div class="container">
                    <div class="row">
                        <div class="col-12 text-center">
                            <br><br><br><br>
                            <h3 class="mb-4 Service">Welcome <span style = "color: #13547a;font-weight: 700;">{{user_name}}  </span><img src="{{ url_for('Note.static', filename='images/hands.png') }}" style="width: 60px;"></img>  We're excited to have you with us!</h3>
                       
                        </div>
                    </div>
                </div>
            </section>
            
            <section class="featured-section">
                <div class="container">
                    <div class="row">
                        <!-- Column for the Upload Button, Image, and Text -->
                        <div class="col-lg-9 col-12 mb-4 mb-lg-0">
                            <div class="custom-block bg-white shadow-lg">
                                <!-- Upload Image Button (Centered at the top) -->
                                {% if success %}
                                <div class="alert alert-success mt-3" role="alert">
                                    {{ success }}
                                </div>
                            {% endif %}
                                <form id="upload-form" method="post" enctype="multipart/form-data" action="{{ url_for('Note.UploadImage') }}">
                                    <input name='image' type="file" id="image" class="hidden-file-input" accept="image/*" onchange="document.getElementById('upload-form').submit();">
                                    {% if not image_url %}
                                        <div class="d-flex justify-content-center align-items-center">
                                            <img src="{{ url_for('Note.static', filename='images/cloud.png') }}" alt="" class="mr-2">  
                                        </div>   
                                        <br>
                                        <p class="d-flex align-items-center justify-content-center"><strong>Please choose an image file from your device</strong></p>
                                        <p class="d-flex align-items-center justify-content-center"><strong>to upload and extract text from it</strong></p>
                                    {% endif %}
                                        <div class="d-flex  justify-content-center">
                                        {% if not image_url %}
                                          
                                            <button type="button" class="btn custom-btn mt-2 mt-lg-3" onclick="document.getElementById('image').click();">Select Image</button>                                       
                                        {% endif %}
                                    </div>
                                </form>
            
                                {% if error %}
                                    <div class="alert alert-danger mt-3" role="alert">
                                        {{ error }}
                                    </div>
                                {% endif %}
            
                                <!-- Image Section (Below the Upload Button) -->
                                {% if image_url %}
                                    <div>{{ image_url }}</div>
                                    <div name="image" class="image-upload">
                                        <img src="{{ url_for('Note.static', filename='temp/' + image_url) }}" class="custom-block-image img-fluid" alt="">
                                    </div>
                                    <img src="../static/temp/Aws.png" alt="">

                                {% endif %}
                            </div>
                        </div>
                        {% if extracted_text %}
                        <section class="featured-section">
                            <div class="container">
                                <div class="row">
                                    <!-- Affichage du texte extrait et formulaire pour le sauvegarder -->
                                    <div class="col-lg-9 col-12 mb-4 mb-lg-0" id="section_6">
                                        <div class="custom-block bg-white shadow-lg">
                                            
                                                <!--<p id="extracted-text-header" class="btn custom-btn mt-2 mt-lg-3" style="background-color: #13547a; margin-left: 37%;">Extracted Text</p>-->
                                                
                                                <!-- Formulaire pour sauvegarder les données -->
                                                <form id="save-form" method="POST" action="{{ url_for('Note.save_note') }}">
 
                                                    <div id="title-container" style="display: hidden; margin-top: 10px;">
                                                        <label for="title"></label>
                                                        <input type="text" placeholder="Enter a title" id="title" name="title" class="btn custom-btn mt-2 mt-lg-3" style="background-color: #13547a; margin-left: 37%; color: antiquewhite;" required>
                                                    </div> 
                                                   
                                                    <!-- Champ pour le texte extrait -->
                                                    <div>
                                                        <textarea style="width: 100%;" name="extracted_text" required>{{ extracted_text }}</textarea>
                                                    </div> 
                                                   
                                                    <!-- Tags suggérés -->
                                                    <h4 style="margin-top: 20px;">Suggested Tags:</h4>
                                                    <div id="tags-container" style="display: flex; align-items: center; gap: 10px;">
                                                       
                                                        {% for tag in suggested_tags %}
                                                            <input type="hidden" name="tags" value="{{ tags }}">
                                                            <p class="btn custom-btn mt-2 mt-lg-3 tag">#{{ tag }}</p>
                                                        {% endfor %}   
                                                                                                       
                                                        <p id="add-tag-btn" style="width: 37px; height: 37px; background-color: aliceblue; color: #80d0c7; font-size: 25px; font-weight: bold; border-radius: 50%; border: none; display: flex; align-items: center; justify-content: center; cursor: pointer; margin-top: 20px;">+</p>
                                                        
                                                    </div>                                               

                                                    <div id="new-tag-container" style="display: none; margin-left: 10px;">
                                                        <input type="text" id="new-tag-input" placeholder="Enter new tag" style="padding: 5px; font-size: 14px;">
                                                        <button type="button" id="add-new-tag" style= "margin-left: 5px; padding: 5px 10px; background-color: #80d0c7; color: aliceblue; border: none; cursor: pointer; font-size: 14px; border-radius: 10px;"><strong>Add Tag</strong></button>
                                                    </div>

                                                    <input type="hidden" name="image_name" value="{{ image_url }}">
                                                    <button type="button" id="save-button" class="btn custom-btn mt-2 mt-lg-3" style="color: #80d0c7; background-color: aliceblue; margin-left: 90%;">Save</button>
                                                </form>
                                            
                                            {% else %}
                                                
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>
                        </div>  
                    </div>
                </div>
            </section>
        
            
           
            <section class="timeline-section section-padding" id="#">
                <div class="section-overlay"></div>
            
                <div class="container">
                    <div class="row">
                        <div class="col-12 text-center">
                            <h2 class="text-white mb-4 Service">How to Make the Most of SnapNotes</h2>
                        </div>
            
                        <div class="col-lg-10 col-12 mx-auto">
                            <div class="timeline-container">
                                <ul class="vertical-scrollable-timeline" id="vertical-scrollable-timeline">
                                    <div class="list-progress">
                                        <div class="inner"></div>
                                    </div>
            
                                    <li>
                                        <h4 class="text-white mb-3">Snap a Picture of Your Notes</h4>
                                        <p class="text-white">
                                            Use your phone to take a clear picture of your notes. Ensure good lighting and avoid blurry images for better text extraction.
                                        </p>
                                        <div class="icon-holder">
                                            <i class="bi-camera"></i>
                                        </div>
                                    </li>
            
                                    <li>
                                        <h4 class="text-white mb-3">Organize and Review Your Notes</h4>
                                        <p class="text-white">
                                            Edit and structure the extracted text before saving. Use the app’s features to categorize and refine your content as needed.
                                        </p>
                                        <div class="icon-holder">
                                            <i class="bi-list-task"></i>
                                        </div>
                                    </li>
            
                                    <li>
                                        <h4 class="text-white mb-3">Maximize Your Note-Taking Experience</h4>
                                        <p class="text-white">
                                            Follow best practices: ensure neat handwriting, review notes thoroughly, and make use of the app’s categorization options for better organization.
                                        </p>
                                        <div class="icon-holder">
                                            <i class="bi-lightbulb"></i>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
            
                        <div class="col-12 text-center mt-5">
                            <p class="text-white">
                                Ready to make the most of SnapNotes? 
                                <a href="#" class="btn custom-btn custom-border-btn ms-3">Get Started Now</a>
                            </p>
                        </div>
                    </div>
                </div>
            </section>
            
            
            
            <section class="contact-section section-padding section-bg" id="section_5">
                <div class="container">
                    <div class="row">

                        <div class="col-lg-12 col-12 text-center">
                            <h2 class="mb-5">Get in touch</h2>
                        </div>

                        <div class="col-lg-5 col-12 mb-4 mb-lg-0">
                            <iframe class="google-map" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2595.065641062665!2d-122.4230416990949!3d37.80335401520422!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x80858127459fabad%3A0x808ba520e5e9edb7!2sFrancisco%20Park!5e1!3m2!1sen!2sth!4v1684340239744!5m2!1sen!2sth" width="100%" height="250" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                        </div>

                        <div class="col-lg-6 col-md-6 col-12 mx-auto">
                            <h4 class="mb-3">Ensas</h4>

                            <p>Route Sidi Bouzid BP 63 Rue Sidi M'Barek, Safi 46000</p>

                            <hr>

                            <p class="d-flex align-items-center mb-1">
                                <span class="me-2">Phone</span>

                                <a href="tel: +212 688062914" class="site-footer-link">
                                    +212 688062914
                                </a>
                            </p>

                            <p class="d-flex align-items-center">
                                <span class="me-2">Email</span>

                                <a href="mailto:info@company.com" class="site-footer-link">
                                    snapnotes@company.com
                                </a>
                            </p>
                        </div>

                    </div>
                </div>
            </section>
        </main>

        <footer class="site-footer section-padding">
            <div class="container">
                <div class="row">

                    <div class="col-lg-4 col-12 mb-4 pb-2">
                        <a class="navbar-brand mb-2" href="index.html">
                            <i class="bi-back"></i>
                            <span>SnapNotes</span>
                        </a>
                    </div>

                    <div class="col-lg-4 col-md-4 col-6">
                        <h6 class="site-footer-title mb-3">Resources</h6>

                        <ul class="site-footer-links">
                            <li class="site-footer-link-item">
                                <a href="#" class="site-footer-link">New Note</a>
                            </li>

                            <li class="site-footer-link-item">
                                <a href="#" class="site-footer-link">How it works</a>
                            </li>

                            <li class="site-footer-link-item">
                                <a href="#" class="site-footer-link">FAQs</a>
                            </li>

                            <li class="site-footer-link-item">
                                <a href="#" class="site-footer-link">Contact</a>
                            </li>
                        </ul>
                    </div>

                    <div class="col-lg-4 col-md-4 col-6 mb-4 mb-lg-0">
                        <h6 class="site-footer-title mb-3">Information</h6>

                        <p class="text-white d-flex mb-1">
                            <a href="tel: +212 688062914" class="site-footer-link">
                                +212 688062914
                            </a>
                        </p>

                        <p class="text-white d-flex">
                            <a href="mailto:info@company.com" class="site-footer-link">
                                snapnotes@company.com
                            </a>
                        </p>
                    </div>

                    <div class="col-lg-3 col-md-4 col-12 mt-4 mt-lg-0 ms-auto">
  
                    </div>

                </div>
            </div>
        </footer>

        <!-- JAVASCRIPT FILES -->
        <script src="{{ url_for('Note.static', filename='js/jquery.min.js') }}"></script>
        <script src="{{ url_for('Note.static', filename='js/bootstrap.bundle.min.js') }}"></script>
        <script src="{{ url_for('Note.static', filename='js/jquery.sticky.js') }}"></script>
        <script src="{{ url_for('Note.static', filename='js/click-scroll.js') }}"></script>
        <script src="{{ url_for('Note.static', filename='js/custom.js') }}"></script>
        <script>
            // Auto-submit form when a file is selected
            document.getElementById('image').addEventListener('change', function() {
                document.getElementById('upload-form').submit();
            });


            {% if image_url %}
                document.addEventListener("DOMContentLoaded", function() { document.getElementById("section_2").scrollIntoView({ behavior: 'smooth' }); }); 
            {% endif %}

            {% if extracted_text %}
            document.addEventListener("DOMContentLoaded", function() { document.getElementById("section_6").scrollIntoView({ behavior: 'smooth' }); }); 
            {% endif %}
        </script>

        <script>
            // Lorsque l'utilisateur clique sur le bouton "+"
            document.getElementById("add-tag-btn").addEventListener("click", function() {
                document.getElementById("new-tag-container").style.display = "block";  // Afficher le champ de texte
            });

            // Lorsque l'utilisateur clique sur "Add Tag"
            document.getElementById("add-new-tag").addEventListener("click", function() {
                var newTag = document.getElementById("new-tag-input").value.trim();
                if (newTag) {
                    var tagsContainer = document.getElementById("tags-container");
                    //var addButton = document.getElementById("add-tag-btn");
                    // Créer un nouvel élément pour le tag
                    var newTagElement = document.createElement("p");
                    newTagElement.classList.add("btn", "custom-btn", "mt-2", "mt-lg-3", "tag");
                    /*newTagElement.style.backgroundColor = "#80d0c7";
                    newTagElement.style.color = "aliceblue";
                    newTagElement.style.fontSize = "14px";
                    newTagElement.style.marginLeft = "5px";*/
                    newTagElement.innerText = "#" + newTag;

                    // Ajouter le tag au conteneur (à côté des autres)
                    tagsContainer.insertBefore(newTagElement, tagsContainer.firstChild);
                    /*var hiddenTagInput = document.createElement("input");
                    hiddenTagInput.type = "hidden";
                    hiddenTagInput.name = "tags[]";
                    hiddenTagInput.value = newTag;
                    tagsContainer.appendChild(hiddenTagInput);*/

                    // Cacher le champ de texte et réinitialiser
                document.getElementById("new-tag-container").style.display = "none";
                    document.getElementById("new-tag-input").value = "";
                } else {
                    alert("Le champ tag est vide.");
                }
            });
            //ihssane
            
            
       

        </script>
        <script>
            //ihssane 
            /*document.addEventListener('DOMContentLoaded', function () {
            // Add the event listener for the initial tags
            document.querySelectorAll('.tag').forEach(tag => {
                tag.addEventListener('click', function () {
                    // Toggle the 'active' class for this specific tag element
                    this.classList.toggle('active');
                });
            });
        })*/
       /*
        document.getElementById('tags-container').addEventListener('click', function(event) {
        if (event.target.classList.contains('tag')) {
            // Toggle the 'active' class for the dynamically added tag
            event.target.classList.toggle('active');
        }
    });*/
                /*document.addEventListener('DOMContentLoaded', function () {
                // Handle clicks on existing tags
                document.querySelectorAll('.tag').forEach(tag => {
                    tag.addEventListener('click', function () {
                        // Toggle the 'active' class for this specific tag element
                        this.classList.toggle('active');
                        // Handle the creation/removal of hidden input based on the active state
                        handleTagActivation(this);
                    });
                });*/

                // Event delegation for dynamically added tags (in case new tags are added later)
                document.getElementById('tags-container').addEventListener('click', function(event) {
                    if (event.target.classList.contains('tag')) {
                        // Toggle the 'active' class for the clicked tag
                        event.target.classList.toggle('active');
                        // Handle the creation/removal of hidden input based on the active state
                        handleTagActivation(event.target);
                    }
                });

                // Function to create or remove hidden input based on tag activation
                function handleTagActivation(tagElement) {
                    // Check if the tag is active
                    if (tagElement.classList.contains('active')) {
                        // Create the hidden input for the active tag
                        var hiddenTagInput = document.createElement("input");
                        hiddenTagInput.type = "hidden";
                        hiddenTagInput.name = "tags[]";  // Use the same name for all tags
                        hiddenTagInput.value = tagElement.innerText.substring(1);  // Remove the '#' symbol

                        // Append the hidden input to the form
                        document.getElementById("save-form").appendChild(hiddenTagInput);
                    } else {
                        // If the tag is not active, find and remove the corresponding hidden input
                        var hiddenInputs = document.querySelectorAll('input[name="tags[]"]');
                        hiddenInputs.forEach(input => {
                            if (input.value === tagElement.innerText.substring(1)) {
                                input.remove(); // Remove the hidden input for this tag
                            }
                        });
                    }
                }
            

        </script>

        <script>
            document.addEventListener("DOMContentLoaded", function () {
                let saveClicked = false; // Variable pour suivre l'état du clic

                // Écouter les clics sur le bouton Save
                document.getElementById("save-button").addEventListener("click", function () {
                    if (!saveClicked) {
                        /*const extractedTextHeader = document.getElementById('extracted-text-header');
                        extractedTextHeader.style.display = 'none';*/

                        // Afficher la zone de texte pour le titre
                        const titleContainer = document.getElementById('title-container');
                        titleContainer.style.display = 'block';

                        this.innerText = "Save"; // Changer le texte du bouton
                        this.type = "submit"
                    } else {
                        // Deuxième clic : soumettre le formulaire
                        const titleInput = document.getElementById("title");
                        if (titleInput.value.trim() === "") {
                            // Alerte si le titre est vide
                            alert("Please enter a title before submitting.");
                        } else {
                            // Soumettre le formulaire
                            document.getElementById("save-form").submit();
                        }
                    }
                });
            });
        </script>  
        

    </body>
</html>
